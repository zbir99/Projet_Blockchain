{"ast":null,"code":"/**\n * Solution simple de stockage de fichiers avec des URLs d'objets\n * Cette approche est simple et fonctionne dans tous les navigateurs\n */\n\n// Map pour stocker les URLs de Blob\nconst fileUrlMap = new Map();\n\n/**\n * Génère un identifiant unique\n */\nconst generateId = () => {\n  return 'doc-' + Math.random().toString(36).substring(2, 15);\n};\n\n/**\n * Stocke un fichier et retourne un identifiant\n * @param {File} file - Le fichier à stocker\n * @returns {Promise<string>} - L'identifiant du fichier\n */\nexport const uploadToIPFS = async file => {\n  try {\n    if (!file) {\n      throw new Error('Aucun fichier fourni');\n    }\n    console.log('Stockage du fichier...');\n\n    // Générer un ID simple\n    const fileId = generateId();\n\n    // Créer une URL d'objet pour le fichier\n    const blobUrl = URL.createObjectURL(file);\n\n    // Stocker l'URL et les informations du fichier\n    fileUrlMap.set(fileId, {\n      url: blobUrl,\n      name: file.name,\n      type: file.type,\n      size: file.size\n    });\n\n    // Enregistrer l'association ID-nom dans sessionStorage pour la persistance\n    sessionStorage.setItem(`file-info-${fileId}`, JSON.stringify({\n      name: file.name,\n      type: file.type,\n      size: file.size\n    }));\n    console.log(`Fichier \"${file.name}\" stocké avec succès`);\n    console.log(`ID: ${fileId}`);\n    return fileId;\n  } catch (error) {\n    console.error('Erreur lors du stockage du fichier:', error);\n    throw error;\n  }\n};\n\n/**\n * Récupère l'URL d'un fichier à partir de son identifiant\n * @param {string} fileId - L'identifiant du fichier\n * @returns {string} - L'URL pour accéder au fichier\n */\nexport const getIPFSGatewayURL = fileId => {\n  if (!fileId) return '';\n\n  // Vérifier si l'ID est dans notre Map\n  if (fileUrlMap.has(fileId)) {\n    return fileUrlMap.get(fileId).url;\n  }\n  console.warn(`Fichier avec l'ID ${fileId} non trouvé - la page a peut-être été rechargée`);\n  return '';\n};\nexport default {\n  uploadToIPFS,\n  getIPFSGatewayURL\n};","map":{"version":3,"names":["fileUrlMap","Map","generateId","Math","random","toString","substring","uploadToIPFS","file","Error","console","log","fileId","blobUrl","URL","createObjectURL","set","url","name","type","size","sessionStorage","setItem","JSON","stringify","error","getIPFSGatewayURL","has","get","warn"],"sources":["C:/Users/yassi/OneDrive/Desktop/tp_9/Certification-de-Diplomes/src/utils/ipfs.js"],"sourcesContent":["/**\n * Solution simple de stockage de fichiers avec des URLs d'objets\n * Cette approche est simple et fonctionne dans tous les navigateurs\n */\n\n// Map pour stocker les URLs de Blob\nconst fileUrlMap = new Map();\n\n/**\n * Génère un identifiant unique\n */\nconst generateId = () => {\n  return 'doc-' + Math.random().toString(36).substring(2, 15);\n};\n\n/**\n * Stocke un fichier et retourne un identifiant\n * @param {File} file - Le fichier à stocker\n * @returns {Promise<string>} - L'identifiant du fichier\n */\nexport const uploadToIPFS = async (file) => {\n  try {\n    if (!file) {\n      throw new Error('Aucun fichier fourni');\n    }\n    \n    console.log('Stockage du fichier...');\n    \n    // Générer un ID simple\n    const fileId = generateId();\n    \n    // Créer une URL d'objet pour le fichier\n    const blobUrl = URL.createObjectURL(file);\n    \n    // Stocker l'URL et les informations du fichier\n    fileUrlMap.set(fileId, {\n      url: blobUrl,\n      name: file.name,\n      type: file.type,\n      size: file.size\n    });\n    \n    // Enregistrer l'association ID-nom dans sessionStorage pour la persistance\n    sessionStorage.setItem(`file-info-${fileId}`, JSON.stringify({\n      name: file.name,\n      type: file.type,\n      size: file.size\n    }));\n    \n    console.log(`Fichier \"${file.name}\" stocké avec succès`);\n    console.log(`ID: ${fileId}`);\n    \n    return fileId;\n  } catch (error) {\n    console.error('Erreur lors du stockage du fichier:', error);\n    throw error;\n  }\n};\n\n/**\n * Récupère l'URL d'un fichier à partir de son identifiant\n * @param {string} fileId - L'identifiant du fichier\n * @returns {string} - L'URL pour accéder au fichier\n */\nexport const getIPFSGatewayURL = (fileId) => {\n  if (!fileId) return '';\n  \n  // Vérifier si l'ID est dans notre Map\n  if (fileUrlMap.has(fileId)) {\n    return fileUrlMap.get(fileId).url;\n  }\n  \n  console.warn(`Fichier avec l'ID ${fileId} non trouvé - la page a peut-être été rechargée`);\n  return '';\n};\n\nexport default {\n  uploadToIPFS,\n  getIPFSGatewayURL\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA;AACA,MAAMA,UAAU,GAAG,IAAIC,GAAG,CAAC,CAAC;;AAE5B;AACA;AACA;AACA,MAAMC,UAAU,GAAGA,CAAA,KAAM;EACvB,OAAO,MAAM,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;AAC7D,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,YAAY,GAAG,MAAOC,IAAI,IAAK;EAC1C,IAAI;IACF,IAAI,CAACA,IAAI,EAAE;MACT,MAAM,IAAIC,KAAK,CAAC,sBAAsB,CAAC;IACzC;IAEAC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;;IAErC;IACA,MAAMC,MAAM,GAAGV,UAAU,CAAC,CAAC;;IAE3B;IACA,MAAMW,OAAO,GAAGC,GAAG,CAACC,eAAe,CAACP,IAAI,CAAC;;IAEzC;IACAR,UAAU,CAACgB,GAAG,CAACJ,MAAM,EAAE;MACrBK,GAAG,EAAEJ,OAAO;MACZK,IAAI,EAAEV,IAAI,CAACU,IAAI;MACfC,IAAI,EAAEX,IAAI,CAACW,IAAI;MACfC,IAAI,EAAEZ,IAAI,CAACY;IACb,CAAC,CAAC;;IAEF;IACAC,cAAc,CAACC,OAAO,CAAC,aAAaV,MAAM,EAAE,EAAEW,IAAI,CAACC,SAAS,CAAC;MAC3DN,IAAI,EAAEV,IAAI,CAACU,IAAI;MACfC,IAAI,EAAEX,IAAI,CAACW,IAAI;MACfC,IAAI,EAAEZ,IAAI,CAACY;IACb,CAAC,CAAC,CAAC;IAEHV,OAAO,CAACC,GAAG,CAAC,YAAYH,IAAI,CAACU,IAAI,sBAAsB,CAAC;IACxDR,OAAO,CAACC,GAAG,CAAC,OAAOC,MAAM,EAAE,CAAC;IAE5B,OAAOA,MAAM;EACf,CAAC,CAAC,OAAOa,KAAK,EAAE;IACdf,OAAO,CAACe,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;IAC3D,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,iBAAiB,GAAId,MAAM,IAAK;EAC3C,IAAI,CAACA,MAAM,EAAE,OAAO,EAAE;;EAEtB;EACA,IAAIZ,UAAU,CAAC2B,GAAG,CAACf,MAAM,CAAC,EAAE;IAC1B,OAAOZ,UAAU,CAAC4B,GAAG,CAAChB,MAAM,CAAC,CAACK,GAAG;EACnC;EAEAP,OAAO,CAACmB,IAAI,CAAC,qBAAqBjB,MAAM,iDAAiD,CAAC;EAC1F,OAAO,EAAE;AACX,CAAC;AAED,eAAe;EACbL,YAAY;EACZmB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}